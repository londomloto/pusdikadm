<dom-module id="form-pendaftaran-conf">
    <template>
        <style include="form-style"></style>

        <kct-ajax id="ajax"></kct-ajax>

        <div class="section">
            <h3 class="section-title">Data Peserta</h3>
            <div>
                <paper-input label="Nama Lengkap" value="{{ record.data.su_fullname }}" readonly></paper-input>
                <paper-input label="Jenis Kelamin" value="{{ record.data.su_sex }}" readonly></paper-input>

                <kct-column columns="2">
                    <div>
                        <paper-input label="Tempat Lahir" value="{{ record.data.su_pob }}" readonly></paper-input>
                    </div>
                    <div>
                        <paper-input label="Tanggal Lahir" value="{{ record.data.su_dob }}" readonly></paper-input>
                    </div>
                </kct-column>

                <paper-input label="No. Induk Pagawai" value="{{ record.data.su_no }}" readonly></paper-input>
                <paper-input label="Pangkat / Gol. Ruang" value="{{ record.data.su_grade }}" readonly></paper-input>
                
                <kct-combobox 
                    url="/jobs" 
                    label="Jabatan (Pekerjaan)" 
                    value="{{ record.data.su_sj_id }}" 
                    page-size="10" 
                    item-label-path="sj_name" 
                    item-value-path="sj_id" 
                    autoload readonly></kct-combobox>

                <kct-combobox 
                    url="/departments" 
                    label="Unit Kerja" 
                    value="{{ record.data.su_sdp_id }}" 
                    page-size="10" 
                    item-label-path="sdp_name" 
                    item-value-path="sdp_id" 
                    autoload readonly></kct-combobox>
                <kct-combobox 
                    url="/company" 
                    label="Organisasi" 
                    value="{{ record.data.su_scp_id }}" 
                    page-size="10" 
                    item-label-path="scp_name" 
                    item-value-path="scp_id" 
                    autoload readonly></kct-combobox>

            </div>
        </div>

        <div class="section">
            <h3 class="section-title">Data Akun</h3>
            <div>
                <paper-input type="email" label="Alamat Email *" value="{{ record.data.su_email }}"  readonly></paper-input>
                <kct-combobox 
                    url="/roles" 
                    label="Group Akses (Role) *" 
                    value="{{ record.data.su_sr_id }}" 
                    page-size="10" 
                    item-label-path="sr_name" 
                    item-value-path="sr_id" 
                    autoload readonly></kct-combobox>
            </div>
        </div>

        <div class="section">
            <h3 class="section-title">Data Kegiatan</h3>
            <div>
                <paper-input label="Nama Kegiatan" value="{{ record.task.tt_title }}" readonly></paper-input>    
            </div>
        </div>

        <div class="section">
            <h3 class="section-title">Data Autentikasi</h3>
            <div>
                <paper-input label="Catatan autentikasi" value="{{ record.data.su_validation }}" readonly></paper-input>
            </div>
        </div>

        <div class="section section-primary">
            <h3 class="section-title">Data Konfirmasi</h3>
            <div>
                <p>Menunggu konfirmasi dari peserta. Jika dalam beberapa waktu tidak ada konfirmasi, lakukan konfirmasi ulang dengan menekan tombol di bawah.</p>
                <div class="m-t">
                    <paper-button class="btn-green" on-tap="__onInviteTap">Kirim Ulang Konfirmasi</paper-button>
                </div>
            </div>
        </div>
    </template>
    <script>
        class FormPendaftaranConf extends FormBase {
            static get is() {
                return 'form-pendaftaran-conf';
            }

            ready() {
                super.ready();
                this.set('readonly', true);
            }

            __onInviteTap() {
                let payload = {
                    email: this.record.data.su_email
                };

                this.$.ajax.POST('/users/reinvite', payload).then(res => {
                    this.toast('Success', 'Permintaan konfirmasi sudah dikirim');
                });
            }
        }

        customElements.define(FormPendaftaranConf.is, FormPendaftaranConf);
    </script>
</dom-module>